%!PS-Adobe-2.0
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%        This Postscript is Copyright (c) 2016, Peter J Billam          %
% Permission is granted  to any individual or institution to use, copy, %
% modify or redistribute this software, so long as it is not resold for %
% profit, and provided this notice is retained. It is provided "as is", %
% without any express or implied warranty.    http://www.pjb.com.au     %
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%EndComments
%%BeginProlog
(/home/pjb/ps/lib/pjb_motifs.ps) run
(/home/pjb/ps/lib/colours.ps) run
(/home/pjb/ps/lib/brownian.ps) run
%%EndProlog
%%Page: 1 1
%%BeginPageSetup
%%EndPageSetup
/xmax currentpagedevice (PageSize) get 1 get def
/ymax currentpagedevice (PageSize) get 0 get def
0 xmax translate -90 rotate

0 0 xmax ymax darkblue black true 0.8 rectgradientfill

/n 63 def
/r ymax 0.370 mul def
7 1 n { /i exch def
  /angle i 28 div 360 mul cvi 360 mod def
  /x  xmax n 9 add div i 1 add mul  angle cos r mul sub  def
  /y  ymax 0.55 mul     angle sin r mul add  def
  i 14 eq { darkred setrgbcolor } { white setrgbcolor } ifelse
  angle 180 gt { /sun_angle 5 def } { /sun_angle 185 def } ifelse
  x y  r 0.08 mul  sun_angle   angle cvi 360 mod 360 div   moon_path  fill
} for

black setrgbcolor
991 srand
/redness 1.3 def   % 0=whitenoise, 1=pinknoise, 2=rednoise
/n_harmonics 50 def
/delta_x xmax 200 div def
/horizon ymax 0.16 mul def
0 xmax ymax 0.030 mul  redness n_harmonics new_brownian_curve
newpath xmax 0 moveto 0 0 lineto
/x 0 def {
   /y x brownian_curve def
     x y horizon add  xmax 0.47 mul x sub dup mul 1500 div add lineto
   /x x delta_x add def   x xmax gt { exit } if
} loop closepath fill


showpage
%%EOF
