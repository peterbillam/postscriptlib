%!PS-Adobe-2.0
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%        This Postscript is Copyright (c) 2016, Peter J Billam          %
% Permission is granted  to any individual or institution to use, copy, %
% modify or redistribute this software, so long as it is not resold for %
% profit, and provided this notice is retained. It is provided "as is", %
% without any express or implied warranty.    http://www.pjb.com.au     %
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%EndComments
%%BeginProlog
(/home/pjb/ps/lib/transforms.ps) run
/xmax currentpagedevice (PageSize) get 0 get def
/ymax currentpagedevice (PageSize) get 1 get def

/rect { 4 dict begin   [ /h /w /y /x ] { exch def } forall
  x y moveto w 0 rlineto 0 h rlineto 0 w sub 0 rlineto x y lineto closepath
end } def

/circle { 3 dict begin  [ /r /y /x ] { exch def } forall
  % 2 index 0 index add  1 index  moveto
  % 0 360 arc
  x r add y moveto  x y r 0 360 arc  x r add y moveto closepath
  end
} def

%%EndProlog
%%Page: 1 1
%%BeginPageSetup
%%EndPageSetup
/Times-Bold  ymax .03 mul selectfont
  xmax .15 mul ymax .95 mul moveto (perspective_xy2uv  with no theta) show
/xvp xmax .55  mul def
/yvp ymax .27 mul def
0.8 setgray 0 0 xmax yvp rectfill % the ground
% xvp yvp translate   % the vanishing-point must be 0,0

/HelveticaBold  ymax .22 mul selectfont
newpath 0.5 setgray  /x0  xmax .05 mul def
% left of the vanishing-point, we start printing text at ::x0
x0 ymax .82 mul moveto (HEMNHXWENZEYKHEMM) true charpath
x0 ymax .63 mul moveto (EMNHXWENZEYKHEMMA) true charpath
x0 ymax .42 mul moveto (MNHXWENZEYKHEMMAD) true charpath
x0 ymax .22 mul moveto (MHXWENZEYKHEMMADX) true charpath
x0 ymax .02 mul moveto (HXWENZEYKHEMMADXM) true charpath
[ xvp yvp x0 ] /perspective_xy2uv c_transform fill

% but right of the VP, we start the text at x0-stringwidth
newpath  0  setgray  /x0 xmax .95 mul def
/x_start_of_string  x0 (OQCSU) stringwidth pop sub def
x_start_of_string  ymax .82 mul moveto (QCSUO) true charpath
x_start_of_string  ymax .62 mul moveto (OQCSU) true charpath
x_start_of_string  ymax .42 mul moveto (UOQCS) true charpath
x_start_of_string  ymax .22 mul moveto (SUOQC) true charpath
x_start_of_string  ymax .02 mul moveto (CSUOQ) true charpath
[ xvp yvp x0 ] /perspective_xy2uv c_transform fill

showpage

%%Page: 2 2
%%BeginPageSetup
%%EndPageSetup
/Times-Bold  ymax .03 mul selectfont
  xmax .15 mul ymax .95 mul moveto (perspective_xy2uv  with theta) show
/xvp xmax .55  mul def
/yvp ymax 0.27 mul def
0.8 setgray 0 0 xmax yvp rectfill % the ground
/HelveticaBold  ymax .22 mul selectfont

newpath 0.5 setgray  /x0  xmax .05 mul def
% left of the vanishing-point, we start printing text at x0
x0 ymax .82 mul moveto (HEMNHXWENZEYKHEMM) true charpath
x0 ymax .62 mul moveto (EMNHXWENZEYKHEMMA) true charpath
x0 ymax .42 mul moveto (MNHXWENZEYKHEMMAD) true charpath
x0 ymax .22 mul moveto (MHXWENZEYKHEMMADX) true charpath
x0 ymax .02 mul moveto (HXWENZEYKHEMMADXM) true charpath
[xvp yvp x0 30] /perspective_xy2uv c_transform fill

% but right of the VP, we start the text at x0-stringwidth
newpath /x0 xmax .95 mul def
0 setgray
/x_start_of_string  x0 (OQCSU) stringwidth pop sub def
x_start_of_string  ymax .82 mul moveto (QCSUO) true charpath
x_start_of_string  ymax .62 mul moveto (OQCSU) true charpath
x_start_of_string  ymax .42 mul moveto (UOQCS) true charpath
x_start_of_string  ymax .22 mul moveto (SUOQC) true charpath
x_start_of_string  ymax .02 mul moveto (CSUOQ) true charpath
[xvp yvp x0 30] /perspective_xy2uv c_transform fill

showpage

%%Page: 3 3
%%BeginPageSetup
%%EndPageSetup
/Times-Bold  ymax .03 mul selectfont
  xmax .15 mul ymax .95 mul moveto (perspective_flat_xy2uv) show
/xvp xmax .55  mul def   /yvp ymax 0.27 mul def
0.8 setgray 0 0 xmax yvp rectfill 0.5 setgray  % the ground

.10 .35 12.0 { /y exch yvp mul def
  xvp .3 mul  y  xvp 1.2 mul  yvp .11 mul rect
} for
0 setgray
[ xvp yvp  yvp .10 mul  20 ] /perspective_flat_xy2uv c_transform fill

xvp  .40 mul  yvp .05 mul xvp .08 mul xvp 12 mul rect
xvp 1.35 mul  yvp .05 mul xvp .08 mul xvp 12 mul rect
0.5 setgray
[ xvp yvp  yvp .10 mul  20 ] /perspective_flat_xy2uv c_transform fill

showpage

%%Page: 4 4
%%BeginPageSetup
%%EndPageSetup

newpath
0.8 setgray
/w xmax .04 mul def
xmax .005 mul setlinewidth
.03 .06 .93 {     /x exch xmax mul def
  .03 .04 .96 {  /y exch ymax mul def x y w w rect } for
} for
% [x_amplitude y_wavelength y_phase  y_amplitude x_wavelength x_phase]
/params [9 300 0  6 200 90] def
params /sine_xy2uv c_transform fill

newpath 0.5 setgray
% a simple long lineto does not become wavy ; only the joinpoints get moved!
10 205 moveto   15 5 580 { 205 lineto } for
params /sine_xy2uv c_transform stroke
/Times-Bold  ymax .03 mul selectfont 0 setgray
  xmax .15 mul ymax .95 mul moveto (sine_xy2uv) show

showpage

%%Page: 5 5
%%BeginPageSetup
%%EndPageSetup

newpath
0.7 setgray
/w xmax .04 mul def
xmax .005 mul setlinewidth
.03 .06 .93 {     /x exch xmax mul def
  .03 .04 .96 {  /y exch ymax mul def x y w w rect } for
} for
[ 120 700 80 1.8 ]  /softlens_xy2uv c_transform
[ 120 450 80 1.8 ]  /hardlens_xy2uv c_transform
[ 350 200 70 60 ]   /twist_xy2uv    c_transform fill
/Times-Bold  ymax .03 mul selectfont 0 setgray
  xmax .05 mul ymax .95 mul moveto (softlens_xy2uv) show
  xmax .05 mul ymax .65 mul moveto (hardlens_xy2uv) show
  xmax .05 mul 200 moveto (twist_xy2uv) show

showpage

%%Page: 6 6
%%BeginPageSetup
%%EndPageSetup

newpath 0.7 setgray
/w xmax .02 mul def
.05 .06 .97 {    /x exch xmax mul def
  .04 .04 .98 {  /y exch ymax mul def x y w circle } for
} for
[ 295 345  70 140 ]  /collapse_xy2uv    c_transform fill
/Times-Bold  ymax .03 mul selectfont 0 setgray
  xmax .15 mul ymax .95 mul moveto (collapse_xy2uv) show

showpage

%%Page: 7 7
%%BeginPageSetup
%%EndPageSetup
/hollywood_xy2uv {   % params: [ xl yl  width  heightup heightdown ]
  % Probably text at start and end should be approx .10 of height in middle,
  % but this means 1) doing the transform 2) measuring the new pathbbox
  % 3) rescaling.  This does not fit into the *_xy2uv architecture...
  % Perhaps there is an explicit formula for how much the width shrinks ?
  2 dict begin  [ /y /x ] { exch def } forall
  x y
  end
} def
/HelveticaBold  ymax .22 mul selectfont
/w (HOLLYWOOD) stringwidth pop def
/xl xmax w sub .50 mul def
/yl ymax .40 mul def
xl yl moveto (HOLLYWOOD) true charpath
[ xl yl  w  w .40 mul  w .10 mul ]   /hollywood_xy2uv    c_transform fill

/Times-Bold  ymax .03 mul selectfont 0 setgray
  xmax .15 mul ymax .95 mul moveto (hollywood_xy2uv) show

showpage

% could also do something [ pathbbox x_power y_power ] /something_xy2uv
% or [ llx lly yrx ury x_power y_power ] to gravitate the points r/l / u/d

%%EOF
